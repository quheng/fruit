#include <graphics.h>
#include <dos.h>
#include <bios.h>
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#define M1 262
#define M2 296
#define M3 330
#define M4 349
#define M5 392
#define M6 440
#define M7 494
#define H1 523
#define H2 587
#define H3 659
#define H4 699
#define H5 784
#define H6 880
#define H7 988
#define S1 1047
#define S2 1175
#define S3 1319
#define S4 1397
#define S5 1568
#define S6 1760
#define S7 1976

#define qq 15
#define ww 30
#define ee 60

void interrupt (*faddr)();
void interrupt (*handler)();

int freq0[]={
		 784,660,588,660,523,523,
         588,494,440,523,392,392,
         330,392,440,523,784,440,523,392,
         784,1048,880,784,660,784,588,588,
         588,660,494,440,392,440,523,588,
         330,523,440,392,440,523,392,392,
         660,784,494,588,440,523,392,392,
         330,392,330,392,392,440,494,588,440,440,392,440,
         523,588,784,660,588,660,588,523,440,392,
         330,523,440,523,440,392,330,392,440,523,
		 392,392,660,784,588,660,588,523,494,440,784,784,0
		 };


int dely0[]={
		 25,50,12,12,50,50,
         25,50,12,12,50,50,
         50,38,12,38,12,12,12,25,
         38,12,12,12,12,12,50,50,
         38,12,25,25,38,12,25,25,
         25,25,12,12,12,12,50,50,
         38,12,25,25,12,12,50,25,
         12,12,12,12,12,12,12,12,50,25,12,12,
         38,12,25,25,25,12,12,25,12,12,
         50,50,12,12,12,12,12,12,12,12,
		 50,25,12,12,12,12,12,12,25,25,50,50,0
		 };
int freq1[]={
		 0,H1,H1,H2,
		 H3,H3,H3,H4,H3, 0,H3,H2,H1,H2,H2,H2,H4,H3,0 ,H2,H1,M7,H1,M7,H1,M7,M6,M5,M5,0 ,0 ,H1,H2,H3,
		 H4,M6,H1,M7,0 ,M5,H3,H4,H3,H2,H1,0 ,H1,M7,H1,H4,H3,H2,H1,H4,H3,H2,H1,H2,0 ,0 ,H1,H1,H2,
		 H3,H3,H3,H4,H3,0 ,H3,H2,H1,H2,H2,H2,H4,H3,0 ,H2,H1,M7,H1,M7,H1,M7,H1,H6,H5,H5,H4,H3,H5,
	     H5,H6,H4,H3,H2,0,H2,H3,H4,H4,H5,H3,H2,H1,0,H1,M7,H1,H4,H3,H4,M6,H1,M7,H1,H1,H1,0,0,
		 H4,H4,H4,H4,H3,M7,H3,H2,H2,H1,H1,0 ,H1,H4,H3,H2,H3,H4,H3,H4,0,H6,H6,H7,H5,H4,H4,H5,H3,0,
		 H6,H6,H6,H6,H5,H6,H7, 0,H3,H7,S1,H7,H5,H1,0 ,H4,H3,H2,H1,H4,H3,H4,H5,H5,
		 0,H5,H5,H7,S1,S1,S1,H5,H5,0 ,H5,H5,S1,S2,S2,S2,H5,H5,S2,S3,S2,S1,S1,S1,0,H7,H7,S1,H7,H5,
		 H6,S2,0 ,H2,H2,H3,H4,H3,H4,H6,H5,0 ,H4,H3,H4,H5,H5,S2,H7,S1,0 ,S1,H7,H5,H4,H3,H4,H5,H6,S3,S2,S1,S2,
		 0,H5,H5,H7,S1,S1,S1,H5,H5,0 ,H5,H5,S1,S2,S2,S2,H5,H5,S2,S3,S2,S1,S1,S1,0,S1,H7,S1,H7,H5,
		 H6,S3,S3, 0,H4,H4,H5,H6,H5,H6,S1,H7, 0,H7,H7,H6,H5,H5,S3,S2,S1,0 ,S1,H7,H5,H4,H3,H4,H5,H6,S3,S2,S1,S2, 0,-1
};
int dely1[]={
		 10,10,10,10,
		 20,20,20,10,50,10,10,10,10,20,20,20,10,50,20,20,20,10,30,10,20,20,20,10,50,10,10,10,10,10,
		 40,20,20,40,20,10,20,20,20,10,10,20,20,20,20,20,20,20,10,30,20,20,10,50,40,10,10,10,10,
		 20,20,20,10,50,10,10,10,10,20,20,20,10,30,20,20,20,10,30,10,20,20,20,10,50,20,20,20,20,
		 20,20,20,10,50,10,10,10,10,20,20,20,10,10,20,20,20,20,20,20,20,20,40,20,10,80,10,40,
		 20,20,20,10,30,20,20,20,20,10,10,20,10,20,20,20,20,20,10,10,20,20,20,20,20,20,20,10,50,40,
		 20,20,20,10,30,10,10,20,10,20,10,30,20,40,40,20,10,30,10,30,20,20,10,50,0,
		 10,10,10,10,10,20,30,20,50,10,10,10,10,20,10,30,10,50,20,20,20,10,10,20,10,20,20,20,20,0,
		 20,50,10,10,10,10,20,20,20,10,50,10,10,10,10,20,20,20,10,10,20,20,20,20,20,10,20,20,20,20,20,10,50,
		 10,10,10,10,10,20,30,20,50,10,10,10,10,20,10,30,10,50,20,20,20,10,10,20,10,20,20,20,20,
		 20,20,40,10,10,10,10,20,20,20,10,50,10,10,10,10,20,20,20,10,10,20,20,20,20,20,10,20,20,20,20,20,10,50,30,0,
};

int freq2[]={
		 784,0
		 };


int dely2[]={
		 25,0
		 };
void interrupt normal()
{
	static int no,j;
	if (freq1[no]!=-1)
	{
		if (j==0) sound(freq1[no]);
		if (j<dely1[no]/3)
		{
			j++;
			return;
		}
		nosound();
		no++;
		j=0;
	}
	else no=0;
}

void interrupt th()
{
	static int no,j;
	if (freq0[no]!=-1)
	{
		if (j==0) sound(freq0[no]);
		if (j<dely0[no]/3)
		{
			j++;
			return;
		}
		nosound();
		no++;
		j=0;
	}
	else no=0;
}

void interrupt aim()
{
	static int no,j;
	if (freq2[no]!=-1)
	{
		if (j==0) sound(freq2[no]);
		if (j<dely2[no]/3)
		{
			j++;
			return;
		}
		nosound();
		no++;
		j=0;
	}
	else no=0;
}


void setbgm(){
	setvect(0x1c,normal);
}

void setaim(){
	setvect(0x1c,aim);
}

void setth(){
	setvect(0x1c,th);
}

